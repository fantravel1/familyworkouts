---
interface Props {
  title: string;
  description: string;
  slug: string;
  category: string;
  duration: number;
  difficulty: 'beginner' | 'intermediate' | 'advanced';
  ageGroups: string[];
  thumbnailUrl?: string;
  youtubeId?: string;
  featured?: boolean;
}

const {
  title,
  description,
  slug,
  category,
  duration,
  difficulty,
  ageGroups,
  thumbnailUrl,
  youtubeId,
  featured = false
} = Astro.props;

const thumbnail = thumbnailUrl || (youtubeId ? `https://i.ytimg.com/vi/${youtubeId}/hqdefault.jpg` : '/images/placeholder-workout.jpg');

const categoryIcons: Record<string, string> = {
  dance: 'ğŸ’ƒ',
  yoga: 'ğŸ§˜',
  hiit: 'ğŸ”¥',
  strength: 'ğŸ’ª',
  sports: 'âš½',
  outdoor: 'ğŸŒ³',
  adaptive: 'â™¿',
  games: 'ğŸ®',
  cultural: 'ğŸŒ',
};

const difficultyColors: Record<string, string> = {
  beginner: 'badge-beginner',
  intermediate: 'badge-intermediate',
  advanced: 'badge-advanced',
};

const categoryIcon = categoryIcons[category] || 'ğŸƒ';
const href = `/workouts/${category}/${slug}/`;
---

<article class="card group cursor-pointer" data-workout-card>
  <a href={href} class="block">
    <!-- Thumbnail -->
    <div class="video-thumbnail relative">
      <img
        src={thumbnail}
        alt={`${title} workout thumbnail`}
        class="w-full h-full object-cover"
        loading="lazy"
        decoding="async"
      />
      <!-- Play Button Overlay -->
      <div class="video-play-btn">
        <div class="w-16 h-16 bg-white/90 rounded-full flex items-center justify-center shadow-lg">
          <svg class="w-8 h-8 text-coral ml-1" fill="currentColor" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7z"/>
          </svg>
        </div>
      </div>
      <!-- Duration Badge -->
      <div class="absolute bottom-2 right-2 bg-black/70 text-white text-xs font-medium px-2 py-1 rounded">
        {duration} min
      </div>
      <!-- Featured Badge -->
      {featured && (
        <div class="absolute top-2 left-2 bg-gradient-sunrise text-navy text-xs font-bold px-2 py-1 rounded-full">
          Featured
        </div>
      )}
    </div>

    <!-- Content -->
    <div class="p-4">
      <!-- Category and Difficulty -->
      <div class="flex items-center gap-2 mb-2">
        <span class="text-lg" aria-hidden="true">{categoryIcon}</span>
        <span class="text-sm text-soft-gray capitalize">{category}</span>
        <span class="text-soft-gray">â€¢</span>
        <span class:list={['badge', difficultyColors[difficulty]]}>
          {difficulty}
        </span>
      </div>

      <!-- Title -->
      <h3 class="font-bold text-lg text-navy mb-1 line-clamp-2 group-hover:text-coral transition-colors">
        {title}
      </h3>

      <!-- Description -->
      <p class="text-sm text-soft-gray line-clamp-2 mb-3">
        {description}
      </p>

      <!-- Age Groups -->
      <div class="flex flex-wrap gap-1">
        {ageGroups.slice(0, 3).map((age) => (
          <span class="text-xs bg-ocean/10 text-ocean px-2 py-0.5 rounded-full">
            {age}
          </span>
        ))}
        {ageGroups.length > 3 && (
          <span class="text-xs bg-gray-100 text-soft-gray px-2 py-0.5 rounded-full">
            +{ageGroups.length - 3} more
          </span>
        )}
      </div>
    </div>
  </a>
</article>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>
